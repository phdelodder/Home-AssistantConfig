- id: Start_Up_Home_Assistant
  alias: Start Up Home Assistant
  trigger:
  - platform: homeassistant
    event: start
  action:
  - service: script.turn_on
    entity_id: script.start_up_home_assistant
- alias: Update Last Motion
  id: Update Last Motion
  initial_state: 'on'
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.bureau_motion
    - binary_sensor.speelkamer_motion
    - binary_sensor.motion_achterdeur
    - binary_sensor.oprit_camera
    - binary_sensor.voor_deur
    - binary_sensor.achter_deur
    - binary_sensor.keuken_deur
    - binary_sensor.garage_deur
    - binary_sensor.motion_wc_boven
    - binary_sensor.motion_wc_beneden
    - binary_sensor.motion_gang_eerste_2
    - binary_sensor.motion_gang_eerste_1
    - binary_sensor.motion_inkom
    - binary_sensor.motion_gang_zolder
    - binary_sensor.motion_voordeur
    - binary_sensor.motion_bureau
    - binary_sensor.motion_logeerkamer
    - binary_sensor.motion_speelkamer
    - binary_sensor.motion_living
    to: 'on'
  action:
    service: variable.set_variable
    data:
      variable: last_motion
      attributes_template: "{\n      \"history_1\": \"{{ variable.state }}\",\n  \
        \    \"history_2\": \"{{ variable.attributes.history_1 }}\",\n      \"history_3\"\
        : \"{{ variable.attributes.history_2 }}\",\n      \"history_4\": \"{{ variable.attributes.history_3\
        \ }}\",\n      \"history_5\": \"{{ variable.attributes.history_4 }}\",\n \
        \     \"history_6\": \"{{ variable.attributes.history_5 }}\",\n      \"history_7\"\
        : \"{{ variable.attributes.history_6 }}\",\n      \"history_8\": \"{{ variable.attributes.history_7\
        \ }}\",\n      \"history_9\": \"{{ variable.attributes.history_8 }}\",\n \
        \     \"history_10\": \"{{ variable.attributes.history_9 }}\"\n}\n"
    data_template:
      value: '{{ trigger.to_state.attributes.friendly_name|replace(''motion sensor'','''')
        }}: {{as_timestamp(states.variable.last_motion.last_changed)| timestamp_custom(''%X'')
        }}

        '
- id: '1575277594428'
  alias: Set night profile for oprit camera
  description: ''
  trigger:
  - event: sunset
    platform: sun
  condition: []
  action:
  - service: shell_command.set_oprit_profile_night
- id: '1575277627609'
  alias: Set day profile for oprit camera
  description: ''
  trigger:
  - event: sunrise
    platform: sun
  condition: []
  action:
  - service: shell_command.set_oprit_profile_day
- id: '1578590308661'
  alias: NachtTafel Licht Febe Aan
  description: ''
  trigger:
  - device_id: aecf8a3bd0144f6f9fbbedf7e7c503dc
    domain: deconz
    platform: device
    subtype: turn_on
    type: remote_button_short_press
  condition:
  - condition: device
    device_id: 9d61839836424735bb9de4c9ad91230a
    domain: light
    entity_id: light.nachttafel_febe
    type: is_off
  action:
  - entity_id: scene.default_nachttafel_febe
    service: scene.turn_on
- id: NachtTafel Licht Febe Uit
  alias: NachtTafel Licht Febe Uit
  description: ''
  trigger:
  - device_id: aecf8a3bd0144f6f9fbbedf7e7c503dc
    domain: deconz
    platform: device
    subtype: turn_on
    type: remote_button_short_press
  condition:
  - condition: device
    device_id: 9d61839836424735bb9de4c9ad91230a
    domain: light
    entity_id: light.nachttafel_febe
    type: is_on
  action:
  - entity_id: light.febe_leds
    service: light.turn_off
  mode: single
- id: '1578590350074'
  alias: NachtTafel Licht Margot Aan
  description: ''
  trigger:
  - device_id: ed641ace598140ab84eff39005e4e6d0
    domain: deconz
    platform: device
    subtype: turn_on
    type: remote_button_short_press
  condition:
  - condition: device
    device_id: 5a5791e30bae435f93fc82b4bbb5dfb8
    domain: light
    entity_id: light.nachttafel_margot
    type: is_off
  action:
  - entity_id: scene.default_nachttafel_margot
    service: scene.turn_on
- id: '1586931483975'
  alias: Send Notification Afval Collection
  description: ''
  trigger:
  - at: '18:00'
    platform: time
  condition:
    condition: or
    conditions:
    - condition: state
      entity_id: sensor.recycleapp_morgen
      state: papier, pmd
    - condition: state
      entity_id: sensor.recycleapp_morgen
      state: restafval
    - condition: state
      entity_id: sensor.recycleapp_morgen
      state: groenafval
  action:
  - data: {}
    service: script.notify_afval
- id: '1587360682923'
  alias: Alarm Clock Philippe
  description: https://flemmingss.com/wake-up-light-based-on-android-alarm-with-home-assistant-and-tasker/
  trigger:
  - platform: template
    value_template: '{% set alarm_time = as_timestamp(states(''input_datetime.philippe_phone_next_alarm''))
      %}

      {% set time_now = as_timestamp(states(''sensor.date_time'').replace('','',''''))
      %}

      {{ time_now >= ( alarm_time - 300) }}'
  condition:
  - condition: state
    entity_id: input_boolean.philippe_phone_alarm_set
    state: 'on'
  - condition: state
    entity_id: person.philippe
    state: home
  action:
  - service: script.turn_on
    entity_id: script.wakeup_light_sunrise
    data:
      variables:
        entity_id: light.led_slaapkamer
- id: Sync Tasmota states
  alias: Sync Tasmota states
  trigger:
  - event: start
    platform: homeassistant
  action:
  - data:
      payload: ''
      topic: cmnd/tasmotas/state
    service: mqtt.publish
  - data:
      payload: ''
      topic: cmnd/tasmotas/shutterposition
    service: mqtt.publish
  - data:
      payload: ''
      topic: tasmotas/cmnd/state
    service: mqtt.publish
  - data:
      payload: 0
      topic: cmnd/tasmotas/status
    service: mqtt.publish
  initial_state: true
- id: '1587624008968'
  alias: Switch Febe Shaken
  description: ''
  trigger:
  - device_id: aecf8a3bd0144f6f9fbbedf7e7c503dc
    domain: deconz
    platform: device
    subtype: ''
    type: remote_gyro_activated
  condition: []
  action:
  - data_template:
      effect: '{{ state_attr("light.nachttafel_febe", "effect_list") | random }}'
      entity_id: light.nachttafel_febe
      rgb_color:
      - '{{ (range(0, 255)|random) }}'
      - '{{ (range(0, 255)|random) }}'
      - '{{ (range(0, 255)|random) }}'
      transition: '{{ (range(1, 3)|random) }}'
    entity_id: light.febe_leds
    service: light.turn_on
  mode: single
- id: '1587626119060'
  alias: NachtTafel Licht Margot Uit
  description: ''
  trigger:
  - device_id: ed641ace598140ab84eff39005e4e6d0
    domain: deconz
    platform: device
    subtype: turn_on
    type: remote_button_short_press
  condition:
  - condition: device
    device_id: 5a5791e30bae435f93fc82b4bbb5dfb8
    domain: light
    entity_id: light.nachttafel_margot
    type: is_on
  action:
  - data: {}
    entity_id: light.nachttafel_margot
    service: light.turn_off
- id: '1587626206992'
  alias: Switch Margot Shaken
  description: ''
  trigger:
  - device_id: ed641ace598140ab84eff39005e4e6d0
    domain: deconz
    platform: device
    subtype: ''
    type: remote_gyro_activated
  condition: []
  action:
  - data_template:
      effect: '{{ state_attr("light.nachttafel_margot", "effect_list") | random }}'
      rgb_color:
      - '{{ (range(0, 255)|random) }}'
      - '{{ (range(0, 255)|random) }}'
      - '{{ (range(0, 255)|random) }}'
      transition: '{{ (range(1, 3)|random) }}'
    entity_id: light.nachttafel_margot
    service: light.turn_on
- id: Alarm Clock Febe
  alias: Alarm Clock Febe
  trigger:
  - platform: template
    value_template: "{{ states('sensor.time') == \n    (state_attr('input_datetime.febe_next_alarm',\
      \ 'timestamp') - 300)\n         |timestamp_custom('%H:%M', false) }}"
  condition:
  - condition: state
    entity_id: input_boolean.febe_alarm_set
    state: 'on'
  action:
  - data:
      variables:
        entity_id: light.febe_leds
    entity_id: script.wakeup_febe_sunrise
    service: script.turn_on
  - data: {}
    entity_id: input_boolean.febe_alarm_set
    service: input_boolean.turn_off
  mode: single
- id: Alarm Clock Margot
  alias: Alarm Clock Margot
  trigger:
  - platform: template
    value_template: "{{ states('sensor.time') == \n    (state_attr('input_datetime.margot_next_alarm',\
      \ 'timestamp') - 300)\n         |timestamp_custom('%H:%M', false) }}"
  condition:
  - condition: state
    entity_id: input_boolean.margot_alarm_set
    state: 'on'
  action:
  - data:
      variables:
        entity_id: light.nachttafel_margot
    entity_id: script.wakeup_margot_sunrise
    service: script.turn_on
  - data: {}
    entity_id: input_boolean.margot_alarm_set
    service: input_boolean.turn_off
- id: '1588246366774'
  alias: Aandacht Planten
  description: Planten die laag gehalte van water of meststof hebben
  trigger:
  - at: '18:30'
    platform: time
  condition:
  - condition: or
    conditions:
    - below: '25'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_1_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_1_soil_conductivity
    - below: '25'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_2_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_2_soil_conductivity
    - below: '25'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_3_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_3_soil_conductivity
    - below: '25'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_4_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.greenhouse_zone_4_soil_conductivity
    - below: '25'
      condition: numeric_state
      entity_id: sensor.moestuin_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.moestuin_soil_conductivity
    - below: '25'
      condition: numeric_state
      entity_id: sensor.rozemarijn_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.rozemarijn_soil_conductivity
    - below: '25'
      condition: numeric_state
      entity_id: sensor.bloempot_voordeur_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.bloempot_voordeur_soil_conductivity
    - below: '25'
      condition: numeric_state
      entity_id: sensor.olijfboom_moisture
    - below: '100'
      condition: numeric_state
      entity_id: sensor.olijfboom_soil_conductivity
  action:
  - data_template:
      message: "Deze planten vragen vandaag je aandacht: {%if states('sensor.greenhouse_zone_1_moisture')\
        \ | int < 20 %}\n  - Serre Zone 1 heeft water nodig, {{ states('sensor.greenhouse_zone_1_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.greenhouse_zone_1_soil_conductivity')\
        \ | int < 100 %}\n  - Serre Zone 1 heeft meststof nodig, {{ states('sensor.greenhouse_zone_1_soil_conductivity')\
        \ }} µS/cm\n{%- endif %} {%- if states('sensor.greenhouse_zone_2_moisture')\
        \ | int < 20 %}\n  - Serre Zone 2 heeft water nodig, {{ states('sensor.greenhouse_zone_2_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.greenhouse_zone_2_soil_conductivity')\
        \ | int < 100 %}\n  - Serre Zone 2 heeft meststof nodig, {{ states('sensor.greenhouse_zone_2_soil_conductivity')\
        \ }} µS/cm\n{%- endif %} {%- if states('sensor.greenhouse_zone_3_moisture')\
        \ | int < 20 %}\n  - Serre Zone 3 heeft water nodig, {{ states('sensor.greenhouse_zone_3_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.greenhouse_zone_3_soil_conductivity')\
        \ | int < 100 %}\n  - Serre Zone 3 heeft meststof nodig, {{ states('sensor.greenhouse_zone_3_soil_conductivity')\
        \ }} µS/cm\n{%- endif %} {%- if states('sensor.greenhouse_zone_4_moisture')\
        \ | int < 20 %}\n  - Serre Zone 4 heeft water nodig, {{ states('sensor.greenhouse_zone_4_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.greenhouse_zone_4_soil_conductivity')\
        \ | int < 100 %}\n  - Serre Zone 4 heeft meststof nodig, {{ states('sensor.greenhouse_zone_4_soil_conductivity')\
        \ }} µS/cm\n{%- endif %} {%- if states('sensor.moestuin_moisture') | int <\
        \ 25 %}\n  - Moestuin heeft water nodig, {{ states('sensor.moestuin_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.moestuin_soil_conductivity') |\
        \ int < 100 %}\n  - Moestuin heeft meststof nodig, {{ states('sensor.moestuin_soil_conductivity')\
        \ }} µS/cm\n{%- endif %} {%- if states('sensor.rozemarijn_moisture') | int\
        \ < 20 %}\n  - Rozemarijn heeft water nodig, {{ states('sensor.rozemarijn_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.rozemarijn_soil_conductivity')\
        \ | int < 100 %}\n  - Rozemarijn heeft meststof nodig, {{ states('sensor.rozemarijn_soil_conductivity')\
        \ }} µS/cm\n{%- endif %} {%- if states('sensor.bloempot_voordeur_moisture')\
        \ | int < 20 %}\n  - Bloempot voordeur heeft water nodig, {{ states('sensor.bloempot_voordeur_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.bloempot_voordeur_soil_conductivity')\
        \ | int < 100 %}\n  - Bloempot voordeur heeft meststof nodig, {{ states('sensor.bloempot_voordeur_soil_conductivity')\
        \ }} µS/cm\n{%- endif %} {%- if states('sensor.olijfboom_moisture') | int\
        \ < 20 %}\n  - Olijfboom voordeur heeft water nodig, {{ states('sensor.olijfboom_moisture')\
        \ }} %\n{%- endif %} {%- if states('sensor.olijfboom_soil_conductivity') |\
        \ int < 100 %}\n  - Olijfboom voordeur heeft meststof nodig, {{ states('sensor.olijfboom_soil_conductivity')\
        \ }} µS/cm\n{%- endif %}"
    service: notify.hazilverberkenstraatbot
- id: '1588439093079'
  alias: Enable Alarm Margot
  description: ''
  trigger:
  - at: '18:00'
    platform: time
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.margot_alarm_set
    service: input_boolean.turn_on
- id: '1588439142845'
  alias: Enable Alarm Febe
  description: ''
  trigger:
  - at: '18:00'
    platform: time
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.febe_alarm_set
    service: input_boolean.turn_on
- id: Autoswitch to Spotify source For Huis
  alias: Autoswitch to Spotify source For Huis
  trigger:
  - entity_id: media_player.spotify_phdelodder
    platform: state
    to: playing
  - entity_id: media_player.spotify_isabel
    platform: state
    to: playing
  - entity_id: media_player.spotify_febe
    platform: state
    to: playing
  - entity_id: media_player.spotify_margot
    platform: state
    to: playing
  condition:
  - condition: template
    value_template: '{{trigger.to_state.attributes.source==''Huis''}}'
  action:
  - data:
      entity_id:
      - media_player.snapcast_client_hentho
      - media_player.snapcast_client_xgin
      source: Spotify-Huis
    service: media_player.select_source
- id: Autoswitch to Spotify source For Bureau
  alias: Autoswitch to Spotify source For Bureau
  trigger:
  - entity_id: media_player.spotify_phdelodder
    platform: state
    to: playing
  - entity_id: media_player.spotify_isabel
    platform: state
    to: playing
  - entity_id: media_player.spotify_febe
    platform: state
    to: playing
  - entity_id: media_player.spotify_margot
    platform: state
    to: playing
  condition:
  - condition: template
    value_template: '{{trigger.to_state.attributes.source==''Bureau''}}'
  action:
  - data:
      entity_id:
      - media_player.snapcast_client_xgin
      source: Spotify-Bureau
    service: media_player.select_source
  - service: input_select.select_option
    data:
      entity_id: input_select.source_bureau
      option: Spotify
- id: Autoswitch to Spotify source For Woonkamer
  alias: Autoswitch to Spotify source For Woonkamer
  trigger:
  - entity_id: media_player.spotify_phdelodder
    platform: state
    to: playing
  - entity_id: media_player.spotify_isabel
    platform: state
    to: playing
  - entity_id: media_player.spotify_febe
    platform: state
    to: playing
  - entity_id: media_player.spotify_margot
    platform: state
    to: playing
  condition:
  - condition: template
    value_template: '{{trigger.to_state.attributes.source==''Woonkamer''}}'
  action:
  - data:
      entity_id:
      - media_player.snapcast_client_hentho
      source: Spotify-Woonkamer
    service: media_player.select_source
  - service: input_select.select_option
    data:
      entity_id: input_select.source_woonkamer
      option: Spotify
- id: Autoswitch to Spotify source For Tablet
  alias: Autoswitch to Spotify source For Tablet
  trigger:
  - entity_id: media_player.spotify_phdelodder
    platform: state
    to: playing
  - entity_id: media_player.spotify_isabel
    platform: state
    to: playing
  - entity_id: media_player.spotify_febe
    platform: state
    to: playing
  - entity_id: media_player.spotify_margot
    platform: state
    to: playing
  condition:
  - condition: template
    value_template: '{{trigger.to_state.attributes.source==''Tablet''}}'
  action:
  - data:
      entity_id:
      - media_player.snapcast_client_tablet
      source: Spotify-Tablet
    service: media_player.select_source
  - service: input_select.select_option
    data:
      entity_id: input_select.source_tablet
      option: Spotify
- id: Change Source For Snapcast based on input
  alias: Change Source For Snapcast based on input
  trigger:
  - entity_id: input_select.source_bureau
    platform: state
  - entity_id: input_select.source_woonkamer
    platform: state
  - entity_id: input_select.source_tablet
    platform: state
  action:
  - service: media_player.select_source
    data_template:
      source: '{% if (trigger.entity_id == "input_select.source_bureau" and is_state(''input_select.source_bureau'',
        "Radio")) %} Mopidy {% elif (trigger.entity_id == "input_select.source_bureau"
        and is_state(''input_select.source_bureau'', "Spotify")) %} Spotify-Bureau
        {% elif (trigger.entity_id == "input_select.source_bureau" and is_state(''input_select.source_bureau'',
        "Mute")) %} Mute {% elif (trigger.entity_id == "input_select.source_woonkamer"
        and is_state(''input_select.source_woonkamer'', "Radio")) %} Mopidy {% elif
        (trigger.entity_id == "input_select.source_woonkamer" and is_state(''input_select.source_woonkamer'',
        "Spotify")) %} Spotify-Woonkamer {% elif (trigger.entity_id == "input_select.source_woonkamer"
        and is_state(''input_select.source_woonkamer'', "Mute")) %} Mute {% elif (trigger.entity_id
        == "input_select.source_tablet" and is_state(''input_select.source_tablet'',
        "Radio")) %} Mopidy {% elif (trigger.entity_id == "input_select.source_tablet"
        and is_state(''input_select.source_tablet'', "Spotify")) %} Spotify-tablet
        {% elif (trigger.entity_id == "input_select.source_tablet" and is_state(''input_select.source_tablet'',
        "Mute")) %} Mute {% endif %}'
      entity_id: "{% if (trigger.entity_id == \"input_select.source_bureau\") %}\n\
        \    media_player.snapcast_client_xgin\n{% elif (trigger.entity_id == \"input_select.source_woonkamer\"\
        ) %}\n    media_player.snapcast_client_hentho\n{% elif (trigger.entity_id\
        \ == \"input_select.source_tablet\") %}\n    media_player.snapcast_client_tablet\n\
        {% endif %}"
  - service: media_player.volume_set
    data_template:
      entity_id: "{% if (trigger.entity_id == \"input_select.source_bureau\") %}\n\
        \    media_player.snapcast_client_xgin\n{% elif (trigger.entity_id == \"input_select.source_woonkamer\"\
        ) %}\n    media_player.snapcast_client_hentho\n{% elif (trigger.entity_id\
        \ == \"input_select.source_tablet\") %}\n    media_player.snapcast_client_tablet\n\
        {% endif %}"
      volume_level: "{% if (trigger.entity_id == \"input_select.source_bureau\" and\
        \ is_state('input_select.source_bureau', \"Mute\")) %}\n  0\n{% elif (trigger.entity_id\
        \ == \"input_select.source_woonkamer\" and is_state('input_select.source_woonkamer',\
        \ \"Mute\")) %}\n  0\n{% elif (trigger.entity_id == \"input_select.source_tablet\"\
        \ and is_state('input_select.source_tablet', \"Mute\")) %}\n  0\n{% else %}\n\
        \  {% if (trigger.entity_id == \"input_select.source_bureau\") %}\n    {%\
        \ if (states('input_number.volume_bureau') | float) > 0  %}\n       states('input_number.volume_bureau')\
        \ | float\n    {% else %}\n       0.4\n    {% endif %}\n  {% elif (trigger.entity_id\
        \ == \"input_select.source_woonkamer\") %}\n    {% if (states('input_number.volume_woonkamer')\
        \ | float) > 0  %}\n       states('input_number.volume_woonkamer') | float\n\
        \    {% else %}\n       0.3\n    {% endif %}\n  {% elif (trigger.entity_id\
        \ == \"input_select.source_tablet\") %}\n    {% if (states('input_number.source_tablet')\
        \ | float) > 0  %}\n       states('input_number.volume_tablet') | float\n\
        \    {% else %}\n       0.4\n    {% endif %}\n  {% endif %}\n{% endif %}"
  - service: input_number.set_value
    data_template:
      entity_id: "{% if (trigger.entity_id == \"input_select.source_bureau\") %}\n\
        \    input_number.volume_bureau\n{% elif (trigger.entity_id == \"input_select.source_woonkamer\"\
        ) %}\n    input_number.volume_woonkamer\n{% elif (trigger.entity_id == \"\
        input_select.source_tablet\") %}\n    input_number.volume_tablet\n{% endif\
        \ %}"
      value: "{% if (trigger.entity_id == \"input_select.source_bureau\" and is_state('input_select.source_bureau',\
        \ \"Mute\")) %}\n  0\n{% elif (trigger.entity_id == \"input_select.source_woonkamer\"\
        \ and is_state('input_select.source_woonkamer', \"Mute\")) %}\n  0\n{% elif\
        \ (trigger.entity_id == \"input_select.source_tablet\" and is_state('input_select.source_tablet',\
        \ \"Mute\")) %}\n  0\n{% endif %}"
  - condition: template
    value_template: '{{ states(''input_select.source_woonkamer'') != "Radio" and states(''input_select.source_bureau'')
      != "Radio" and states(''input_select.source_tablet'') != "Radio" }}'
  - service: media_player.media_pauze
    data:
      entity_id: media_player.huis
  - service: variable.set_variable
    data:
      variable: radio_playing
      value: ''
- id: Sync Snapcast
  alias: Sync Snapcast
  trigger:
  - event: start
    platform: homeassistant
  - entity_id: media_player.snapcast_client_hentho
    platform: state
  - entity_id: media_player.snapcast_client_tablet
    platform: state
  - entity_id: media_player.snapcast_client_xgin
    platform: state
  action:
  - service: input_number.set_value
    data_template:
      entity_id: input_number.volume_bureau
      value: '{{ state_attr(''media_player.snapcast_client_xgin'', ''volume_level'')
        }}'
  - service: input_number.set_value
    data_template:
      entity_id: input_number.volume_woonkamer
      value: '{{ state_attr(''media_player.snapcast_client_hentho'', ''volume_level'')
        }}'
  - service: input_number.set_value
    data_template:
      entity_id: input_number.volume_tablet
      value: '{{ state_attr(''media_player.snapcast_client_tablet'', ''volume_level'')
        }}'
  - service: input_select.select_option
    data_template:
      entity_id: input_select.source_bureau
      option: "{% if state_attr('media_player.snapcast_client_xgin', 'volume_level')\
        \ == 0 %}\n  Mute\n{% else %}\n    {% if state_attr('media_player.snapcast_client_xgin',\
        \ 'source').startswith('Spotify') %}\n      Spotify\n    {% elif state_attr('media_player.snapcast_client_xgin',\
        \ 'source') == 'Mopidy' %}\n      Radio\n    {% endif %}\n{% endif %}"
  - service: input_select.select_option
    data_template:
      entity_id: input_select.source_woonkamer
      option: "{% if state_attr('media_player.snapcast_client_hentho', 'volume_level')\
        \ == 0 %}\n  Mute\n{% else %}\n    {% if state_attr('media_player.snapcast_client_hentho',\
        \ 'source').startswith('Spotify') %}\n      Spotify\n    {% elif state_attr('media_player.snapcast_client_hentho',\
        \ 'source') == 'Mopidy' %}\n      Radio\n    {% endif %}\n{% endif %}"
  - service: input_select.select_option
    data_template:
      entity_id: input_select.source_tablet
      option: "{% if state_attr('media_player.snapcast_client_tablet', 'volume_level')\
        \ == 0 %}\n  Mute\n{% else %}\n    {% if state_attr('media_player.snapcast_client_tablet',\
        \ 'source').startswith('Spotify') %}\n      Spotify\n    {% elif state_attr('media_player.snapcast_client_tablet',\
        \ 'source') == 'Mopidy' %}\n      Radio\n    {% endif %}\n{% endif %}"
- id: Change Volume For Snapcast based on input
  alias: Change Volume For Snapcast based on input
  trigger:
  - entity_id: input_number.volume_bureau
    platform: state
  - entity_id: input_number.volume_woonkamer
    platform: state
  - entity_id: input_number.volume_tablet
    platform: state
  action:
  - service: media_player.volume_set
    data_template:
      entity_id: "{% if (trigger.entity_id == \"input_number.volume_bureau\") %}\n\
        \    media_player.snapcast_client_xgin\n{% elif (trigger.entity_id == \"input_number.volume_woonkamer\"\
        ) %}\n    media_player.snapcast_client_hentho\n{% elif (trigger.entity_id\
        \ == \"input_number.volume_tablet\") %}\n    media_player.snapcast_client_tablet\n\
        {% endif %}"
      volume_level: "{% if (trigger.entity_id == \"input_number.volume_bureau\") %}\n\
        \   {{ states('input_number.volume_bureau') | float }}\n{% elif (trigger.entity_id\
        \ == \"input_number.volume_woonkamer\") %}\n   {{ states('input_number.volume_woonkamer')\
        \ | float }}\n{% elif (trigger.entity_id == \"input_number.volume_tablet\"\
        ) %}\n   {{ states('input_number.volume_tablet') | float }}\n{% endif %}"
- id: '1589881124105'
  alias: Mute Snapcast Woonkamer, when tv is on
  description: ''
  trigger:
  - entity_id: media_player.samsung_samsung_dtv_rcr
    for: 5s
    platform: state
    to: 'On'
  condition: []
  action:
  - service: input_select.select_option
    data:
      option: Mute
      entity_id: input_select.source_woonkamer
- id: '1591101305128'
  alias: Turn On StuBru in Bureau
  description: ''
  trigger:
  - entity_id: binary_sensor.motion_bureau
    platform: state
    to: 'on'
  condition:
  - condition: template
    value_template: '{{ is_state_attr(''media_player.snapcast_client_tablet'', ''is_volume_muted'',
      true) }}'
  action:
  - data:
      is_volume_muted: false
    entity_id: media_player.snapcast_client_tablet
    service: media_player.volume_mute
  - wait_template: '{{ is_state(''script.play_tts'', ''off'') }}'
  - data: {}
    service: script.turn_on
    entity_id: script.play_studiobrussel_home
- id: '1591102593255'
  alias: Turn Off StuBru in Bureau
  description: ''
  trigger:
  - entity_id: binary_sensor.motion_bureau
    for: 00:20:00
    platform: state
    to: 'off'
  condition:
  - condition: template
    value_template: '{{ is_state_attr(''media_player.snapcast_client_tablet'', ''is_volume_muted'',
      false) }}'
  action:
  - data:
      is_volume_muted: true
    entity_id: media_player.snapcast_client_tablet
    service: media_player.volume_mute
- id: shellies_announce
  alias: Shellies Announce
  trigger:
  - platform: homeassistant
    event: start
  - platform: time_pattern
    hours: /1
  action:
    service: mqtt.publish
    data:
      topic: shellies/command
      payload: announce
- id: shellies_discovery
  alias: Shellies Discovery
  mode: queued
  max: 999
  trigger:
    platform: mqtt
    topic: shellies/announce
  action:
    service: python_script.shellies_discovery
    data_template:
      id: '{{ trigger.payload_json.id }}'
      mac: '{{ trigger.payload_json.mac }}'
      fw_ver: '{{ trigger.payload_json.fw_ver }}'
      shelly1-8A7B0C:
        relay-0-name: Schakelaar Dressing
      shelly1-2C6E97:
        relay-0: light
        relay-0-name: Achterdeur
      shellydimmer-D0F117:
        light-0-name: Gang Eerste Verdiep
- id: '1598594585829'
  alias: Disable Motion Sensor Bureau
  description: ''
  trigger:
  - device_id: a23a7754f95b4a88ad347941e45bfd6b
    domain: deconz
    platform: device
    subtype: turn_on
    type: remote_button_short_press
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.disable_motion_trigger_light_bureau
    service: input_boolean.turn_on
  mode: single
- id: '1598594636282'
  alias: Enable Motion Sensor Bureau
  description: ''
  trigger:
  - device_id: a23a7754f95b4a88ad347941e45bfd6b
    domain: deconz
    platform: device
    subtype: turn_off
    type: remote_button_short_press
  condition: []
  action:
  - data: {}
    entity_id: input_boolean.disable_motion_trigger_light_bureau
    service: input_boolean.turn_off
  mode: single
